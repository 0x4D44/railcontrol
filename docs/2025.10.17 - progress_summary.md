# MSVC Migration Progress Summary (17 Oct 2025)

## Completed Work
- Installed Visual Studio 2022 Community (MSVC 19.44) and verified toolchain.
- Downloaded and built OWLNext 7.0.19 static libraries for Win32 (COMPAT=5) via uild\msvc\build_owlnext_msvc.bat.
- Generated uild/msvc/ solution + project (RailControl.sln/.vcxproj/.filters) covering all legacy sources/resources and linking against OWLNext libs.
- Added uild_msvc.bat wrapper and turned .github/workflows/msvc.yml into a real (allowed-to-fail) MSVC build pipeline.
- Updated core headers (classdef.h, ctl3d.h) for OWLNext 7, removed legacy Win16 macros, switched to modern includes, added owl::TWindowClassName overrides and owl::uint signatures where appropriate.
- Replaced Borland helper APIs (MakeWindow, LoadBitmap, LoadIcon, ExecDialog, andomize, etc.) with OWLNext/Win32-compatible calls, adjusted dialog constructors to take LPCTSTR, and maintained hard-coded font/resource usage via GetModule()->GetHandle().
- Converted text parsing to std::istringstream, swapped itoa for _itoa_s, and ensured TTimetable constructors accept const strings.

## Current MSVC Build Status
- Build progresses through most translation units; remaining errors stem from handler signature mismatches (e.g., EvLButtonDown, EvSize, EvMove overrides) and a few legacy subsystems (sound playback, Layout’s INI/file parsing, open-file dialog).
- No longer blocked by missing headers or compatibility macros; outstanding work is source-level porting to OWLNext 7 APIs and C++17 tightening (const char*, 	ime(), etc.).

## Next Steps
1. Resolve handler signature issues by matching OWLNext prototypes (owl::uint, non-const references where required) and remove erroneous override specifiers.
2. Finish migrating Layout’s helper functions:
   - Replace remaining ExecDialog calls with stack-based dialogs (dlg.Execute()).
   - Swap sndPlaySound for PlaySound (include mmsystem.h, ensure winmm.lib linked) or stub out audio.
   - Review LoadString, GetOpenFileName, istrstream replacements for const correctness.
3. Continue cleaning up hard-coded Win16 leftovers (HWindow usage, _pascal, _far) and adjust message handlers to OWLNext’s expected types (TEventInfo, TDispatch checks).
4. Once compilation succeeds, re-enable the MSVC CI job as required and run through manual smoke tests on the new build.

_Updated by: Build Engineering (17 Oct 2025)_
